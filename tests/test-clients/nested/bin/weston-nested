#!/bin/bash
# Run Weston nested inside Wawona compositor

WAYLAND_DISPLAY="${WAYLAND_DISPLAY:-wayland-0}"
WESTON_BIN=""

# Find Weston binary
if [ -f "$(dirname "$0")/../../weston/build/clients/weston" ]; then
    WESTON_BIN="$(dirname "$0")/../../weston/build/clients/weston"
elif command -v weston &> /dev/null; then
    WESTON_BIN="weston"
else
    echo "Error: Weston not found. Build Weston first with: make test-clients-weston"
    exit 1
fi

echo "Running Weston nested on display: $WAYLAND_DISPLAY"
export WAYLAND_DISPLAY

# Run Weston with wayland backend (nested)
exec "$WESTON_BIN" --backend=wayland --width=800 --height=600 "$@"
